%%%% ISMIR Late-Breaking/Demo Macros (LaTex)
%%%% Adapted from the Paper Template for ISMIR 2019, and to a lesser extent from ICLR (Hugo Larochelle), which was in turn adapted from the NIPS stylefile Macros
%%%% 
%%%% Mohamed Sordo, Jaeyoung Choi. July, 2019


%\usepackage{eso-pic} % used by \AddToShipoutPicture
\RequirePackage{fancyhdr}
%\RequirePackage{natbib}

%%%<<<<<<<<<<>>>>>>>>>>>%%%
%%%TO BE CHANGED EVERY YEAR
\newcommand{\conferenceyear}{2019}
\newcommand{\conferenceedition}{20th}
\newcommand{\conferenceplace}{Delft, The Netherlands}
%%%<<<<<<<<<<>>>>>>>>>>>%%%
%%%<<<<<<<<<<>>>>>>>>>>>%%%

%\def\Hline{\noalign{\hrule height 0.4mm}}
\newcommand{\bm}[1]{\mbox{\boldmath{$#1$}}}
\newcommand{\range}[2]{{#1,\cdots,#2\;}}
\newcommand{\secref}[1]{\mbox{Section~\ref{#1}}}
\newcommand{\tabref}[1]{\mbox{Table~\ref{#1}}}
\newcommand{\figref}[1]{\mbox{Figure~\ref{#1}}}
\newcommand{\eqnref}[1]{\mbox{Eqn~(\ref{#1})}}

% Remove line breaks
\newcommand{\removelinebreaks}[1]{%
  \begingroup\def\\{ }#1\endgroup}

\renewcommand{\sfdefault}{phv}
\renewcommand{\rmdefault}{ptm}
\renewcommand{\ttdefault}{pcr}

% modification to natbib citations
%\setcitestyle{authoryear,round,citesep={;},aysep={,},yysep={;}}

\renewcommand{\topfraction}{0.95}   % let figure take up nearly whole page
\renewcommand{\textfraction}{0.05}  % let figure take up nearly whole page


\setlength{\paperheight}{297mm}
\setlength{\paperwidth}{210mm}
\setlength{\textheight}{232mm}
\setlength{\textwidth}{152mm}
\setlength{\headheight}{0mm}
\setlength{\voffset}{0mm}
\setlength{\hoffset}{0mm}
\setlength{\marginparwidth}{0mm}
\setlength{\parindent}{1pc}
\setlength{\topmargin}{-5mm}
\setlength{\oddsidemargin}{3mm}
\setlength{\evensidemargin}{0mm}

%\def\baselinestretch{0.98}

\def\normalsize{\@setsize\normalsize{12pt}\xpt\@xpt}
\def\small{\@setsize\small{10pt}\ixpt\@ixpt}
\def\footnotesize{\@setsize\footnotesize{9pt}\viiipt\@viiipt}
\def\scriptsize{\@setsize\scriptsize{8pt}\viipt\@viipt}
\def\tiny{\@setsize\tiny{7pt}\vipt\@vipt}
\def\large{\@setsize\large{14pt}\xiipt\@xiipt}
\def\Large{\@setsize\Large{16pt}\xivpt\@xivpt}
\def\LARGE{\@setsize\LARGE{20pt}\xviipt\@xviipt}
\def\huge{\@setsize\huge{23pt}\xxpt\@xxpt}
\def\Huge{\@setsize\Huge{28pt}\xxvpt\@xxvpt}


% Sidemark for Late Breaking/Demo session @ ISMIR2019
\usepackage[color=black]{background}
\backgroundsetup{
	position=current page.west,
	angle=90,
	nodeanchor=center,
	vshift=-5mm,
	opacity=.5,
	scale=3,
	contents=ISMIR Late-Breaking/Demo [Unrefereed]
}



% Specify the dimensions of each page

\addtolength{\headsep}{0.542cm}

\widowpenalty=10000
\clubpenalty=10000

% \thispagestyle{empty}        \pagestyle{empty}
\flushbottom \sloppy

% We're never going to need a table of contents, so just flush it to
% save space --- suggested by drstrip@sandia-2
\def\addcontentsline#1#2#3{}

% Title stuff, taken from deproc.
\def\maketitle{\par
\begingroup
   \def\thefootnote{\fnsymbol{footnote}}
   \def\@makefnmark{\hbox to 0pt{$^{\@thefnmark}$\hss}} % for perfect author
                                                        % name centering
%   The footnote-mark was overlapping the footnote-text,
%   added the following to fix this problem               (MK)
   \long\def\@makefntext##1{\parindent 1em\noindent
                            \hbox to1.8em{\hss $\m@th ^{\@thefnmark}$}##1}
   \@maketitle \@thanks
\endgroup
\setcounter{footnote}{0}
\let\maketitle\relax \let\@maketitle\relax
\gdef\@thanks{}\gdef\@author{}\gdef\@title{}\let\thanks\relax}

% The toptitlebar has been raised to top-justify the first page

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}


%%%From the setspace package
\newcommand{\setstretch}[1]{%
  \def\baselinestretch{#1}%
  \@currsize
}
\newcommand{\restore@spacing}{%
    \par
    \vskip \parskip
    \vskip \baselineskip
  \endgroup
  \vskip -\parskip
  \vskip -\baselineskip
}
\newenvironment{spacing}[1]{%
  \par
  \begingroup
    \setstretch {#1}%
}{%
  \restore@spacing
}
%%%

\newcommand{\permission}{%
\begin{figure}[b]{%
    \footnotesize
    %{\includegraphics[height=0.45cm]{figs/88x31}}
    {\includegraphics[height=0.45cm]{figs/cc_by.pdf}}
    \vskip -.45cm
    \begin{spacing}{1.1}
    \hskip 1.5cm \copyright \hskip .1cm \authorname.
    Licensed under a Creative Commons Attribution 4.0 International License (CC BY 4.0).
    {\bf Attribution: } \authorname.
    ``\removelinebreaks{\@title}'',
    Late Breaking/Demo at the \conferenceedition\ International Society for Music Information Retrieval, \conferenceplace, \conferenceyear.
    \end{spacing}
}
\end{figure}
}

\def\multauthor#1#2{
  \gdef\@author{
  \begin{tabular}{@{}c@{}}
    {\bf #1} \\
    #2\relax
   \end{tabular}%\hskip .3in
  }
%  \def\authorname{#1}
}

\def\oneauthor#1#2{
  \gdef\@author{
  \begin{tabular}{@{}c@{}}
    {\bf #1} \\
    #2\relax
   \end{tabular}%\hskip .3in
  }
  \def\authorname{#1}
}

\def\twoauthors#1#2#3#4{
%  \gdef\@author{
%  \begin{tabular}{@{}c@{}}
%    {\bf #1} \\
%    #2
%  \end{tabular}\hskip .3in
%  \begin{tabular}{@{}c@{}}
%    {\bf #3} \\
%    #4\relax
%  \end{tabular}
%  }
  \gdef\@author{
    \makebox[\textwidth]{%
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #1} \\
        #2
      \end{tabular}
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #3} \\
        #4\relax
      \end{tabular}
      \hfill
    }
  }
  \def\authorname{#1, #3}
}

\def\threeauthors#1#2#3#4#5#6{
  \gdef\@author{
    \makebox[\textwidth]{%
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #1} \\
        #2
      \end{tabular}
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #3} \\
        #4
      \end{tabular}
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #5} \\
        #6\relax
      \end{tabular}
      \hfill
    }
%  \begin{tabular}{@{}c@{}}
%    {\bf #1} \\
%    #2
%  \end{tabular}\hskip .3in
%  \begin{tabular}{@{}c@{}}
%    {\bf #3} \\
%    #4
%  \end{tabular}\hskip .3in
%  \begin{tabular}{@{}c@{}}
%    {\bf #5} \\
%    #6\relax
%  \end{tabular}
  }
  \def\authorname{#1, #3, #5}
}


\def\fourauthors#1#2#3#4#5#6#7#8{
  \gdef\@author{
    \makebox[\textwidth]{%
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #1} \\
        #2
      \end{tabular}
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #3} \\
        #4
      \end{tabular}
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #5} \\
        #6
      \end{tabular}
      \hfill
      \begin{tabular}{@{}c@{}}
        {\bf #7} \\
        #8\relax
      \end{tabular}
      \hfill
    }
%  \begin{tabular}{@{}c@{}}
%    {\bf #1} \\
%    #2
%  \end{tabular}\hskip .2cm
%  \begin{tabular}{@{}c@{}}
%    {\bf #3} \\
%    #4
%  \end{tabular}\hskip .2cm
%  \begin{tabular}{@{}c@{}}
%    {\bf #5} \\
%    #6\relax
%  \end{tabular}\hskip .2cm
%  \begin{tabular}{@{}c@{}}
%    {\bf #7} \\
%    #8\relax
%  \end{tabular}
  }
  \def\authorname{#1, #3, #5, #7}
}


\def\@maketitle{
  %\newpage
  %\null
  \lhead{Extended abstract for Late-Breaking/Demo}
    \rhead{ISMIR 2019}
  \begin{center} 
  {\Large \bf \uppercase \@title \par}
  \vskip 1.0em {
    \large \lineskip .5em
    \begin{tabular}[t]{c}
    \@author \\
    \end{tabular}
    \par
  }
  \end{center}
  \par
  \permission
  \vskip 2.0em
}

%\renewenvironment{abstract}{\vskip.075in\centerline{\large\sc
%Abstract}\vspace{0.5ex}\begin{quote}}{\par\end{quote}\vskip 1ex}

\def\abstract{
  \begin{center}{
  \bf EXTENDED ABSTRACT
  }
  \end{center}
}
\def\endabstract{\par}

\def\title#1{\gdef\@title{{#1}}}


\def\acknowledgments{
  \begin{center}{
  \bf ACKNOWLEDGMENTS
  }
  \end{center}
}
\def\endacknowledgments{\par}

\def\references{
  \begin{center}{
  \bf REFERENCES
  }
  \end{center}
}
\def\endreferences{\par}


% Footnotes
\footnotesep 6.65pt %
\skip\footins 9pt plus 4pt minus 2pt
\def\footnoterule{\kern-3pt \hrule width 12pc \kern 2.6pt }
\setcounter{footnote}{0}

% Lists and paragraphs
\parindent 0pt
\topsep 4pt plus 1pt minus 2pt
\partopsep 1pt plus 0.5pt minus 0.5pt
\itemsep 2pt plus 1pt minus 0.5pt
\parsep 2pt plus 1pt minus 0.5pt
\parskip .5pc


%\leftmargin2em
\leftmargin3pc
\leftmargini\leftmargin \leftmarginii 2em
\leftmarginiii 1.5em \leftmarginiv 1.0em \leftmarginv .5em

%\labelsep \labelsep 5pt

\def\@listi{\leftmargin\leftmargini}
\def\@listii{\leftmargin\leftmarginii
   \labelwidth\leftmarginii\advance\labelwidth-\labelsep
   \topsep 2pt plus 1pt minus 0.5pt
   \parsep 1pt plus 0.5pt minus 0.5pt
   \itemsep \parsep}
\def\@listiii{\leftmargin\leftmarginiii
    \labelwidth\leftmarginiii\advance\labelwidth-\labelsep
    \topsep 1pt plus 0.5pt minus 0.5pt
    \parsep \z@ \partopsep 0.5pt plus 0pt minus 0.5pt
    \itemsep \topsep}
\def\@listiv{\leftmargin\leftmarginiv
     \labelwidth\leftmarginiv\advance\labelwidth-\labelsep}
\def\@listv{\leftmargin\leftmarginv
     \labelwidth\leftmarginv\advance\labelwidth-\labelsep}
\def\@listvi{\leftmargin\leftmarginvi
     \labelwidth\leftmarginvi\advance\labelwidth-\labelsep}

\abovedisplayskip 7pt plus2pt minus5pt%
\belowdisplayskip \abovedisplayskip
\abovedisplayshortskip  0pt plus3pt%
\belowdisplayshortskip  4pt plus3pt minus3pt%


\def\toptitlebar{\hrule height4pt\vskip .25in\vskip-\parskip}

\def\bottomtitlebar{\vskip .29in\vskip-\parskip\hrule height1pt\vskip
.09in} %
%Reduced second vskip to compensate for adding the strut in \@author


\bibliographystyle{plain}

\def\thebibliography#1{
  \references \list
  {[\arabic{enumi}]}{
  \settowidth\labelwidth{[#1]}\leftmargin 1em
  \advance\leftmargin\labelsep
  \usecounter{enumi}
  }
  \def\newblock{\hskip .01em plus .01em minus .01em}
  \sloppy\clubpenalty4000\widowpenalty4000
  \sfcode`\.=1000\relax
}
%\end{references}
\let\endthebibliography=\endlist


\long\def\@makecaption#1#2{
  \vskip 10pt
  \setbox\@tempboxa\hbox{#1. #2}
  \ifdim
    \wd\@tempboxa >\hsize #1. #2\par
  \else
    \hbox
    to\hsize{\hfil\box\@tempboxa\hfil}
  \fi
}


